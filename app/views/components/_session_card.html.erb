<div class="bg-shade-100 shadow-md rounded-lg p-4 flex flex-col gap-y-2">
  <%# スケジュール情報の展開 %>
  <div class="text-sm"><%= schedule.language %>・<%= schedule.track.name %></div>
  <a href="<%#= FIXME %>" class="text-lg font-semibold text-accent underline underline-offset-4 block">
    <%= schedule.title %>
  </a>
  <%# 登壇者情報 %>
  <div class="flex flex-col">
    <% schedule.speakers.each do |speaker| %>
      <div class="flex items-center gap-x-2">
        <%= render 'components/avatar', name: speaker.name, url: speaker.thumbnail, size: 'm' %>
        <div>
          <span class="text-sm font-bold"><%= speaker.name %></span>
          <span class="text-sm text-shade-30"><%= speaker.handle %></span>
        </div>
      </div>
    <% end %>
  </div>
  <%# フレンズボタン（参加者リスト）%>
  <% if attendees.present? %>
    <%= render 'components/friends_button', profiles: attendees, onClick: "console.log('FIXME: clicked Friends Button')" %>
  <% end %>
  <%# 追加・削除ボタン %>
  <% if @plan.new_record? %>
    <% terms_of_service_dialog_id = SecureRandom.uuid %>
    <div data-controller="dialog" data-dialog-element-id-value="<%= terms_of_service_dialog_id %>">
      <button class="add-plan-button p-2 text-sm font-bold min-h-5 normal-button"
              data-action="click->dialog#open"
      >
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class=" smarthr-ui-Icon" role="img" aria-hidden="true" focusable="false" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"></path></svg>
        <%= I18n.t('card.add') %>
      </button>
      <if>
      <dialog id="<%= terms_of_service_dialog_id %>">
        <%= form_with(url: event_plans_path(@plan, event_name: @plan.event.name), model: @plan, method: :post) do |form| %>
          <%= render 'components/dialog', title: I18n.t('dialog.terms_of_service'), action_button: { form_helper: form, title: I18n.t('button.accept_to_add') } do %>
            <span class="text-base"><%= I18n.t('terms_of_service.description') %></span>
            <div class="mt-4 bg-[#E3E5E8] rounded-lg">
              <iframe class="h-full w-full" loading="lazy" src="<%= event_terms_of_service_path(event_name: @event.name) %>"></iframe>
            </div>
            <%= form.hidden_field :title %>
            <%= form.hidden_field :description %>
            <%= form.hidden_field :public %>
            <%= form.hidden_field :initial, value: false %>
            <%= form.hidden_field :add_schedule_id, value: schedule.id %>
          <% end %>
        <% end %>
      </dialog>
    </div>
  <% elsif scheduled == schedule %>
    <%= form_with(url: event_item_path(@plan.plan_schedules.find_by(schedule:), event_name: @plan.event.name), method: :delete ) do |form| %>
      <%= render 'components/button',
                 title: I18n.t('card.remove'),
                 icon: render("components/icons/close"),
                 data: { turbo_frame: row.turbo_frames_id },
                 form_helper: form
      %>
    <% end %>
  <% else %>
    <%= form_with(url: event_plan_items_path(plan_id: @plan.id, event_name: @plan.event.name), method: :post ) do |form| %>
      <% inactive = scheduled && schedule != scheduled %>
      <%= form.hidden_field :schedule_id, value: schedule.id %>
      <%= render 'components/button',
                 title: inactive ? I18n.t('card.inactive') : I18n.t('card.add'),
                 icon: render("components/icons/add"),
                 data: { turbo_frame: row.turbo_frames_id },
                 form_helper: form
      %>
    <% end %>
  <% end %>
</div>
